<header class="header">
    <div class="container">
        <nav class="nav">
            <div class="nav-left">
                <a href="#" class="logo">Keertan Pothi</a>
            </div>
            <div class="header-search">
                <form class="header-search-form" (submit)="handleSearch($event)">
                    <input 
                        type="text" 
                        class="header-search-input" 
                        [(ngModel)]="searchText"
                        (input)="onSearch()"
                        (focus)="showSearchPanel = true"
                        placeholder="Sbd Kojo" 
                        name="searchText">
                    <button type="button" class="keyboard-toggle-btn" (click)="toggleKeyboard()" title="Toggle Punjabi Keyboard">
                        ðŸ”¤
                    </button>
                    <button type="submit" class="header-search-btn">Search</button>
                </form>
            </div>
        </nav>
    </div>
</header>

<!-- Punjabi Keyboard -->
<div class="punjabi-keyboard" [class.show]="showKeyboard">
    <div class="keyboard-body">
        <div class="keyboard-row" *ngFor="let row of keyboardLayout">
            <button 
                *ngFor="let key of row" 
                class="keyboard-key" 
                [class.backspace]="key === 'âŒ«'"
                [class.empty]="key === ''"
                (click)="onKeyPress(key)"
                [disabled]="key === ''">
                {{ key }}
            </button>
        </div>
    </div>
</div>

<!-- Left Tabs Bar -->
<div class="left-tabs">
  <button class="tab-btn" [class.active]="activeTab === 'links'" (click)="openSidePanel('links')">Links</button>
  <button class="tab-btn" [class.active]="activeTab === 'settings'" (click)="openSidePanel('settings')">Settings</button>
  <button class="tab-btn" [class.active]="activeTab === 'history'" (click)="openSidePanel('history')">History</button>
  <button class="tab-btn" [class.active]="activeTab === 'pothi'" (click)="openSidePanel('pothi')">Pothi</button>
</div>

<!-- Side Panel -->
<div class="side-panel" [class.open]="isSidePanelOpen">
  <div class="side-panel-header">
    <h3 *ngIf="activeTab === 'links'">Links</h3>
    <h3 *ngIf="activeTab === 'settings'">Settings</h3>
    <h3 *ngIf="activeTab === 'history'">History</h3>
    <h3 *ngIf="activeTab === 'pothi'">Pothi</h3>
    <button class="close-btn" (click)="closeSidePanel()">Ã—</button>
  </div>
  <div class="side-panel-content">
    <ng-container [ngSwitch]="activeTab">
        <!-- Links Section -->
      <div *ngSwitchCase="'links'">
        <a href="#" class="panel-link">Home</a><br />
        <a href="#" class="panel-link">About</a><br />
        <a href="#" class="panel-link">Contact</a><br />
      </div>

        <!-- Settings Section -->
      <div *ngSwitchCase="'settings'" style="padding-top: 0.3rem;">
           <!-- Single/Presentation View Setting -->
        <label>
          <input type="checkbox" [checked]="viewMode === 'single'" (change)="viewMode = 'single'">
          Single View
        </label>
        <label style="margin-left: 1.5rem;">
          <input type="checkbox" [checked]="viewMode === 'presentation'" (change)="viewMode = 'presentation'">
          Presentation View
        </label>
        <br />
        <hr class="toolbar-divider-hr" />
        <label>
          <input type="checkbox" [(ngModel)]="showGurmukhi" />
          Show Gurmukhi
        </label>
        <br />
        <label for="gurmukhiFontSize">Gurmukhi Font Size:</label><br />
        <input
          id="gurmukhiFontSize"
          type="range"
          min="1"
          max="3"
          step="0.05"
          [(ngModel)]="gurmukhiFontSize"
          style="vertical-align: middle; width: 120px;"
        />
        <span>{{ gurmukhiFontSize * 10 }}</span>
        <br>
        <hr class="toolbar-divider-hr"/>
        <!-- Presentation View Gurmukhi Font Size -->
        <label for="presentationGurmukhiFontSize">Presentation View Gurmukhi Font Size:</label><br />
        <input
          id="presentationGurmukhiFontSize"
          type="range"
          min="1"
          max="8"
          step="0.1"
          [(ngModel)]="presentationGurmukhiFontSize"
          style="vertical-align: middle; width: 120px;"
        />
        <span>{{ presentationGurmukhiFontSize }}rem</span>
        <br />
        <hr class="toolbar-divider-hr" />

        <!-- English settings -->
        <label>
          <input type="checkbox" [(ngModel)]="showEnglish" />
          Show English
        </label>
        <br />
        <label for="englishFontSize">English Font Size:</label><br />
        <input
          id="englishFontSize"
          type="range"
          min="0.7"
          max="2"
          step="0.05"
          [(ngModel)]="englishFontSize"
          style="vertical-align: middle; width: 120px;"
        />
        <span>{{ englishFontSize * 10 }}</span>
        <br>
        <hr class="toolbar-divider-hr" />
        <label>
          <input type="checkbox" [(ngModel)]="showTransliteration" />
          Show Transliteration
        </label>
        <br />
        <label for="transliterationFontSize">Transliteration Font Size:</label>
        <br />
        <input
          id="transliterationFontSize"
          type="range"
          min="0.7"
          max="2"
          step="0.05"
          [(ngModel)]="transliterationFontSize"
          style="vertical-align: middle; width: 120px;"
        />
        <span>{{ transliterationFontSize * 10 }}</span>
        <br />
        <hr class="toolbar-divider-hr" />
      
        <!-- New settings -->
        <label>
          <input type="checkbox" [(ngModel)]="showVishraam" (click)="onToggleVishraam()" />
          Show Vishraam
        </label>
        <!-- <label style="margin-left: 1.5rem;">
          <input type="checkbox" [(ngModel)]="showLadivaar" />
          Ladivaar
        </label> -->
        <br />
        <hr class="toolbar-divider-hr" />
      </div>

      <!-- History Section -->
      <div *ngSwitchCase="'history'">
        <div style="display: flex; align-items: center; justify-content: space-between;">
        <span style="font-weight: 600;">History</span>
        <button 
        class="btn-clear-history" 
        (click)="confirmClearHistory()"
        style="background: none; border: none; color: #e57373; font-size: 1rem; cursor: pointer; margin-left: 1rem;">
        Clear History
        </button>
    </div>
        <div *ngIf="history.length === 0">
          <p>No history yet.</p>
        </div>
        <ul *ngIf="history.length > 0" class="history-list">
          <li *ngFor="let item of history">
            <a href="#" (click)="onSelectItem(item)" class="history-link">
              <span style="font-family: 'Gurakhar', sans-serif;">{{ item.Gurmukhi }}</span>
            </a>
            <hr class="toolbar-divider-hr" />
          </li>
        </ul>
      </div>
        <div *ngSwitchCase="'pothi'">
        <!-- Example history -->
        <p>Pothi functionality coming soon.</p>
      </div>
    </ng-container>
  </div>
</div>
<div class="overlay" [class.active]="isSidePanelOpen" (click)="closeSidePanel()"></div>

<main *ngIf="showSearchPanel && filteredItems.length > 0" class="main-content">
            <!-- Filters-->
    <div class="container">
        <label>
            <input type="radio" name="searchMode" [(ngModel)]="searchMode" value="anywhere" (change)="onSearch()" /> Anywhere
        </label>
        <label style="margin-left: 1.5rem;">
            <input type="radio" name="searchMode" [(ngModel)]="searchMode" value="starts" (change)="onSearch()" /> Starts with
        </label>
    </div>
    <div class="container">
        <!-- Search Results Section -->
        <section class="results-section">
            
            <!-- Results headers-->
            <div class="results-header">
                <h2 class="results-title">Search Results</h2>
                <div class="results-meta">
                    <span class="results-count">Showing 1-{{filteredItems.length}} of {{filteredItems.length}} results</span>
                    <div class="results-sort">
                        <label for="sort">Sort by:</label>
                        <select id="sort">
                            <option value="relevance">Relevance</option>
                            <option value="date">Date</option>
                            <option value="title">Title</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Results -->
            <div class="results-grid">
                <div class="result-card" *ngFor="let item of filteredItems" (click)="onSelectItem(item)">
                  <div class="result-content" style="display: flex; flex-direction: column; align-items: flex-start;">
                    <h3 class="result-title" style="font-family: 'Gurakhar', sans-serif; margin-bottom: 0rem; 
                    text-align: left;">{{ item.Gurmukhi }}</h3>
                    <div style="font-size: 0.95rem; margin-top: 0; margin-bottom: 0.2rem; text-align: left;">
                      <span style="color: #7ecbff;">By </span>
                      <span style="color: #d2691e; font-weight: 500;">{{ item.WriterEnglish }}</span>
                      <span style="color: #7ecbff;"> in </span>
                      <span style="color: #bfa600; font-weight: 500;">{{ item.RaagEnglish }}</span>
                      <span style="color: #7ecbff;"> on Ang {{ item.PageNo }}</span>
                    </div>
                  </div>
                  <!-- <div class="result-meta">
                      <span class="result-date">January 10, 2024</span>
                      <span class="result-category">Academic</span>
                  </div>
                  <div class="result-actions">
                      <button class="btn-primary">Read</button>
                  </div> -->
                </div>
            </div>

        </section>
    </div>
</main>
<main id="details" class="main-content" *ngIf="!showSearchPanel && selectedShabad && selectedShabad.length > 0">
    <div class="container">
        <!-- Details Header Section -->
        <section class="details-header">
            <!-- <div class="details-card"> -->
                <div class="details-main">
                    <!-- <h1 class="details-title" style="font-family: 'Gurakhar', sans-serif;">
                        {{ detailsInfo?.Gurmukhi }}
                    </h1> -->
                    <div class="details-subtitle">
                        <span class="author">{{ detailsInfo?.WriterEnglish }}</span>
                        <span class="separator">â€¢</span>
                        <span class="raag">{{ detailsInfo?.RaagEnglish }}</span>
                        <span class="separator">â€¢</span>
                        <span class="source-label">{{ detailsInfo?.SourceEnglish }}</span>
                        <span class="separator">â€¢</span>
                        <span class="meta-label">Ang {{ detailsInfo?.PageNo }}</span>
                        <span class="separator">â€¢</span>
                        <span class="meta-label">Lines {{ selectedShabad.length }}</span>
                    </div>
                </div>
                
                <div class="details-meta">
                    
                </div>
            <!-- </div> -->
        </section>

        <!-- Content Section -->
        <section class="content-section">
            <div class="verses-container">
                <div
                  class="verse-row"
                  *ngFor="let verse of selectedShabad; let i = index"
                  (click)="viewMode === 'presentation' ? onPresentationVerseClick(verse) : null"
                  style="cursor: pointer;"
                >
                    <div class="verse-content">
                        <div *ngIf="showGurmukhi" class="verse-text" style="font-family: 'Gurakhar', sans-serif;" [style.font-size.rem]="gurmukhiFontSize">
                          <ng-container *ngIf="verse.VishramArray && verse.VishramArray.length > 0; else plainGurmukhi">
                            <ng-container *ngFor="let word of verse.Gurmukhi.split(' '); let wi = index; let last = last">
                              <ng-container *ngIf="getVishraamClass(verse.VishramArray, wi) as vishraamClass">
                                <span [ngClass]="vishraamClass">{{ word }}</span>
                              </ng-container>
                              <ng-container *ngIf="!getVishraamClass(verse.VishramArray, wi)">
                                {{ word }}
                              </ng-container>
                              <span> </span>
                            </ng-container>
                          </ng-container>
                          <ng-template #plainGurmukhi>
                            {{ verse.Gurmukhi }}
                          </ng-template>
                        </div>
                        <div *ngIf="showEnglish && verse.English" class="verse-translation" [style.font-size.rem]="englishFontSize">
                            {{ verse.English }}
                        </div>
                        <div *ngIf="showTransliteration && verse.English" class="verse-translation transliteration" [style.font-size.rem]="transliterationFontSize">
                            {{ verse.Transliteration }}
                        </div>
                    </div>
                    <!-- <div class="verse-actions">
                        <button class="verse-action-btn" title="Copy verse">ðŸ“‹</button>
                        <button class="verse-action-btn" title="Share verse">ðŸ“¤</button>
                    </div> -->
                </div>
            </div>
        </section>

    </div>
</main>

<!-- <footer class="footer">
    <div class="container">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Quick Links</h4>
                <a href="#about">About Us</a>
                <a href="#contact">Contact</a>
                <a href="#faq">FAQ</a>
                <a href="#support">Support</a>
            </div>
            <div class="footer-section">
                <h4>Resources</h4>
                <a href="#guide">Search Guide</a>
                <a href="#api">API Documentation</a>
                <a href="#tools">Search Tools</a>
                <a href="#tips">Tips & Tricks</a>
            </div>
            <div class="footer-section">
                <h4>Legal</h4>
                <a href="#privacy">Privacy Policy</a>
                <a href="#terms">Terms of Service</a>
                <a href="#cookies">Cookie Policy</a>
                <a href="#dmca">DMCA</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Keertan Pothi. All rights reserved.</p>
        </div>
    </div>
</footer> -->